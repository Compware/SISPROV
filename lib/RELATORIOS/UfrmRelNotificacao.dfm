object frmRelNotificacao: TfrmRelNotificacao
  Left = 256
  Top = 138
  Width = 962
  Height = 572
  Caption = 'Relat'#243'rio de Notifica'#231#227'o'
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  OldCreateOrder = False
  OnClose = FormClose
  OnCreate = FormCreate
  OnShow = FormShow
  PixelsPerInch = 96
  TextHeight = 13
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 954
    Height = 89
    Align = alTop
    TabOrder = 0
    object lbStatus: TLabel
      Left = 775
      Top = 48
      Width = 3
      Height = 13
    end
    object SpeedButton1: TSpeedButton
      Left = 792
      Top = 8
      Width = 23
      Height = 22
      Glyph.Data = {
        76010000424D7601000000000000760000002800000020000000100000000100
        04000000000000010000130B0000130B00001000000000000000000000000000
        800000800000008080008000000080008000808000007F7F7F00BFBFBF000000
        FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF0033333333B333
        333B33FF33337F3333F73BB3777BB7777BB3377FFFF77FFFF77333B000000000
        0B3333777777777777333330FFFFFFFF07333337F33333337F333330FFFFFFFF
        07333337F3FF3FFF7F333330F00F000F07333337F77377737F333330FFFFFFFF
        07333FF7F3FFFF3F7FFFBBB0F0000F0F0BB37777F7777373777F3BB0FFFFFFFF
        0BBB3777F3FF3FFF77773330F00F000003333337F773777773333330FFFF0FF0
        33333337F3FF7F37F3333330F08F0F0B33333337F7737F77FF333330FFFF003B
        B3333337FFFF77377FF333B000000333BB33337777777F3377FF3BB3333BB333
        3BB33773333773333773B333333B3333333B7333333733333337}
      NumGlyphs = 2
      Visible = False
      OnClick = SpeedButton1Click
    end
    object SpeedButton2: TSpeedButton
      Left = 816
      Top = 8
      Width = 23
      Height = 22
      Glyph.Data = {
        76010000424D7601000000000000760000002800000020000000100000000100
        04000000000000010000130B0000130B00001000000000000000000000000000
        800000800000008080008000000080008000808000007F7F7F00BFBFBF000000
        FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00333333330070
        7700333333337777777733333333008088003333333377F73377333333330088
        88003333333377FFFF7733333333000000003FFFFFFF77777777000000000000
        000077777777777777770FFFFFFF0FFFFFF07F3333337F3333370FFFFFFF0FFF
        FFF07F3FF3FF7FFFFFF70F00F0080CCC9CC07F773773777777770FFFFFFFF039
        99337F3FFFF3F7F777F30F0000F0F09999937F7777373777777F0FFFFFFFF999
        99997F3FF3FFF77777770F00F000003999337F773777773777F30FFFF0FF0339
        99337F3FF7F3733777F30F08F0F0337999337F7737F73F7777330FFFF0039999
        93337FFFF7737777733300000033333333337777773333333333}
      NumGlyphs = 2
      Visible = False
      OnClick = SpeedButton2Click
    end
    object Label3: TLabel
      Left = 13
      Top = 17
      Width = 60
      Height = 13
      Caption = 'Prov'#237'ncia:'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -11
      Font.Name = 'MS Sans Serif'
      Font.Style = [fsBold]
      ParentFont = False
    end
    object Label4: TLabel
      Left = 12
      Top = 39
      Width = 61
      Height = 13
      Caption = 'Munic'#237'pio:'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -11
      Font.Name = 'MS Sans Serif'
      Font.Style = [fsBold]
      ParentFont = False
    end
    object Label2: TLabel
      Left = 20
      Top = 61
      Width = 52
      Height = 13
      Caption = 'Unidade:'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -11
      Font.Name = 'MS Sans Serif'
      Font.Style = [fsBold]
      ParentFont = False
    end
    object Label6: TLabel
      Left = 776
      Top = 40
      Width = 6
      Height = 13
      Caption = '0'
    end
    object ckComProcesso: TCheckBox
      Left = 376
      Top = 38
      Width = 97
      Height = 17
      Caption = 'Com Processo'
      TabOrder = 0
    end
    object btCampos: TBitBtn
      Left = 864
      Top = 8
      Width = 75
      Height = 25
      Caption = 'Campos'
      TabOrder = 1
      OnClick = btCamposClick
    end
    object btPesquisar: TBitBtn
      Left = 376
      Top = 8
      Width = 75
      Height = 25
      Caption = 'Pesquisar'
      TabOrder = 2
      OnClick = btPesquisarClick
    end
    object btCsv: TBitBtn
      Left = 528
      Top = 40
      Width = 75
      Height = 25
      Caption = 'CSV'
      TabOrder = 3
      Visible = False
      OnClick = btCsvClick
    end
    object btExcel: TButton
      Left = 456
      Top = 8
      Width = 75
      Height = 25
      Caption = 'Excel'
      TabOrder = 4
      OnClick = btExcelClick
    end
    object leProvincia: TRxLookupEdit
      Left = 75
      Top = 13
      Width = 286
      Height = 21
      LookupDisplay = 'DS_PROVINCIA'
      LookupField = 'CD_PROVINCIA'
      LookupSource = dsProvincia
      TabOrder = 5
      OnChange = leProvinciaChange
    end
    object leMunicipio: TRxLookupEdit
      Left = 75
      Top = 35
      Width = 286
      Height = 21
      LookupDisplay = 'DS_MUNICIPIO'
      LookupField = 'CD_MUNICIPIO'
      LookupSource = dsMunicipio
      TabOrder = 6
      OnChange = leMunicipioChange
    end
    object leUnidade: TRxLookupEdit
      Left = 75
      Top = 57
      Width = 286
      Height = 21
      LookupDisplay = 'DS_UNIDADE'
      LookupField = 'CD_UNIDADE'
      LookupSource = dsUnidade
      TabOrder = 7
      OnButtonClick = leUnidadeButtonClick
      OnChange = leUnidadeChange
    end
    object btLimpar: TBitBtn
      Left = 536
      Top = 8
      Width = 74
      Height = 25
      Caption = 'Limpar'
      TabOrder = 8
      OnClick = btLimparClick
    end
    object pbStatus: TProgressBar
      Left = 773
      Top = 64
      Width = 177
      Height = 17
      TabOrder = 9
    end
    object GroupBox1: TGroupBox
      Left = 615
      Top = 12
      Width = 151
      Height = 72
      TabOrder = 10
      object Label1: TLabel
        Left = 11
        Top = 26
        Width = 21
        Height = 13
        Caption = 'De:'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'MS Sans Serif'
        Font.Style = [fsBold]
        ParentFont = False
      end
      object Label5: TLabel
        Left = 12
        Top = 49
        Width = 24
        Height = 13
        Caption = 'At'#233':'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'MS Sans Serif'
        Font.Style = [fsBold]
        ParentFont = False
      end
      object dtDe: TDateTimePicker
        Left = 40
        Top = 23
        Width = 105
        Height = 21
        Date = 42429.883027557870000000
        Time = 42429.883027557870000000
        TabOrder = 0
      end
      object dtAte: TDateTimePicker
        Left = 40
        Top = 46
        Width = 105
        Height = 21
        Date = 42429.883027557870000000
        Time = 42429.883027557870000000
        TabOrder = 1
      end
    end
    object ckPeriodo: TCheckBox
      Left = 626
      Top = 7
      Width = 71
      Height = 17
      Caption = 'Per'#237'odo'
      Font.Charset = DEFAULT_CHARSET
      Font.Color = clWindowText
      Font.Height = -11
      Font.Name = 'MS Sans Serif'
      Font.Style = [fsBold]
      ParentFont = False
      TabOrder = 11
    end
  end
  object grDados: TdxDBGrid
    Left = 0
    Top = 89
    Width = 769
    Height = 443
    Hint = 'Click com bot'#227'o direito do Mouse para atualizar a lista'
    Bands = <
      item
      end>
    DefaultLayout = True
    HeaderPanelRowCount = 1
    KeyField = 'CD_FICHA'
    ShowGroupPanel = True
    ShowSummaryFooter = True
    SummaryGroups = <
      item
        DefaultGroup = False
        SummaryItems = <
          item
            SummaryType = cstCount
          end>
        Name = 'grDadosSummaryGroup1'
      end>
    SummarySeparator = ', '
    Align = alClient
    BorderStyle = bsNone
    ParentShowHint = False
    PopupMenu = PopupMenu2
    ShowHint = True
    TabOrder = 1
    DataSource = DataSource1
    Filter.Active = True
    Filter.AutoDataSetFilter = True
    Filter.Criteria = {00000000}
    GroupPanelColor = 10070188
    GroupPanelFontColor = 14215660
    OptionsBehavior = [edgoAutoSort, edgoDragScroll, edgoEditing, edgoEnterShowEditor, edgoImmediateEditor, edgoStoreToIniFile, edgoTabThrough, edgoVertThrough]
    OptionsView = [edgoBandHeaderWidth, edgoRowSelect, edgoUseBitmap]
    ShowPreviewGrid = False
    ShowRowFooter = True
  end
  object pnCampos: TPanel
    Left = 769
    Top = 89
    Width = 185
    Height = 443
    Align = alRight
    Caption = 'pnCampos'
    TabOrder = 2
    Visible = False
    object ckCampos: TCheckListBox
      Left = 1
      Top = 1
      Width = 183
      Height = 441
      OnClickCheck = ckCamposClick
      Align = alClient
      ItemHeight = 13
      PopupMenu = PopupMenu1
      TabOrder = 0
    end
  end
  object DataSource1: TDataSource
    DataSet = qyNotificacao
    Left = 568
    Top = 224
  end
  object SaveDialog1: TSaveDialog
    DefaultExt = '*.xls'
    Filter = 'Excel|*.xls'
    Left = 280
    Top = 192
  end
  object qyProvincia: TIBQuery
    Database = DM.DB
    Transaction = DM.TS
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'select CD_PAIS, CD_PROVINCIA, DS_PROVINCIA from PROVINCIA')
    Left = 466
    Top = 222
    object qyProvinciaCD_PAIS: TIntegerField
      FieldName = 'CD_PAIS'
      Origin = 'PROVINCIA.CD_PAIS'
      Required = True
    end
    object qyProvinciaCD_PROVINCIA: TIntegerField
      FieldName = 'CD_PROVINCIA'
      Origin = 'PROVINCIA.CD_PROVINCIA'
      Required = True
    end
    object qyProvinciaDS_PROVINCIA: TIBStringField
      FieldName = 'DS_PROVINCIA'
      Origin = 'PROVINCIA.DS_PROVINCIA'
      Required = True
      Size = 50
    end
  end
  object dsProvincia: TDataSource
    DataSet = qyProvincia
    Left = 497
    Top = 221
  end
  object qyMunicipio: TIBQuery
    Database = DM.DB
    Transaction = DM.TS
    BufferChunks = 1000
    CachedUpdates = False
    DataSource = dsProvincia
    SQL.Strings = (
      'select CD_MUNICIPIO, CD_PROVINCIA, DS_MUNICIPIO from MUNICIPIO'
      'where CD_PROVINCIA = :CD_PROVINCIA')
    Left = 466
    Top = 252
    ParamData = <
      item
        DataType = ftInteger
        Name = 'CD_PROVINCIA'
        ParamType = ptUnknown
        Size = 4
      end>
    object qyMunicipioCD_MUNICIPIO: TIntegerField
      FieldName = 'CD_MUNICIPIO'
      Origin = 'MUNICIPIO.CD_MUNICIPIO'
      Required = True
    end
    object qyMunicipioCD_PROVINCIA: TIntegerField
      FieldName = 'CD_PROVINCIA'
      Origin = 'MUNICIPIO.CD_PROVINCIA'
      Required = True
    end
    object qyMunicipioDS_MUNICIPIO: TIBStringField
      FieldName = 'DS_MUNICIPIO'
      Origin = 'MUNICIPIO.DS_MUNICIPIO'
      Required = True
      Size = 50
    end
  end
  object dsMunicipio: TDataSource
    DataSet = qyMunicipio
    Left = 497
    Top = 251
  end
  object qyUnidade: TIBQuery
    Database = DM.DB
    Transaction = DM.TS
    BufferChunks = 1000
    CachedUpdates = False
    DataSource = dsMunicipio
    SQL.Strings = (
      'select CD_UNIDADE, DS_UNIDADE, FL_ATIVA '
      'from UNIDADE'
      'where CD_MUNICIPIO = :CD_MUNICIPIO')
    Left = 466
    Top = 283
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'CD_MUNICIPIO'
        ParamType = ptUnknown
      end>
    object qyUnidadeCD_UNIDADE: TIntegerField
      FieldName = 'CD_UNIDADE'
      Origin = 'UNIDADE.CD_UNIDADE'
      Required = True
    end
    object qyUnidadeDS_UNIDADE: TIBStringField
      FieldName = 'DS_UNIDADE'
      Origin = 'UNIDADE.DS_UNIDADE'
      Required = True
      Size = 50
    end
    object qyUnidadeFL_ATIVA: TIBStringField
      FieldName = 'FL_ATIVA'
      Origin = 'UNIDADE.FL_ATIVA'
      FixedChar = True
      Size = 1
    end
  end
  object dsUnidade: TDataSource
    DataSet = qyUnidade
    Left = 497
    Top = 282
  end
  object PopupMenu1: TPopupMenu
    Left = 304
    Top = 280
    object MarcarTodos1: TMenuItem
      Caption = 'Marcar Todos'
      OnClick = MarcarTodos1Click
    end
    object DesmarcarTodos1: TMenuItem
      Caption = 'Desmarcar Todos'
      OnClick = DesmarcarTodos1Click
    end
  end
  object PopupMenu2: TPopupMenu
    Left = 200
    Top = 248
    object Marcar2: TMenuItem
      Caption = 'Marcar'
      OnClick = Marcar2Click
    end
    object Desmarcar2: TMenuItem
      Caption = 'Desmarcar'
      OnClick = Desmarcar2Click
    end
    object N1: TMenuItem
      Caption = '-'
    end
    object Excluir1: TMenuItem
      Caption = 'Excluir'
      OnClick = Excluir1Click
    end
    object Abrir1: TMenuItem
      Caption = 'Abrir'
      OnClick = Abrir1Click
    end
  end
  object qyNotificacao: TIBDataSet
    Database = DM.DB
    Transaction = DM.TS
    AfterScroll = qyNotificacaoAfterScroll
    OnCalcFields = qyNotificacaoCalcFields
    BufferChunks = 1000
    CachedUpdates = False
    DeleteSQL.Strings = (
      'delete from "NOTIFICACAO"'
      'where'
      '  "CD_FICHA" = :"OLD_CD_FICHA" and '
      '  "CD_UND" = :"OLD_CD_UND"')
    SelectSQL.Strings = (
      'SELECT'
      '    '#39'TODOS'#39' TODOS,'
      '   '#39'N'#39' SEL,'
      '     N.*'
      ' '#9',N.CD_OCUPACAO CC_OCUPACAO'
      #9',O.DS_OCUPACAO OCUPACAO'
      #9',U.DS_UNIDADE   UNIDADE'
      #9',N.CD_UNIDADE   CC_UNIDADE'
      #9',N.CD_MUNICIPIO CC_MUNICIPIO'
      
        #9',datediff (year, P2.DT_NASCIMENTO, N.DT_NOTIFICACAO) NR_IDADE_I' +
        'DENTIFICACAO'
      #9',M.DS_MUNICIPIO MUNICIPIO'
      #9',N.CD_PROVINCIA_NOT CC_PROVINCIA'
      #9',P.DS_PROVINCIA PROVINCIA'
      #9',U2.DS_UNIDADE UNIDADE_TRATAMENTO'
      #9',N.CD_UNIDADE_TRATAMENTO CC_UNIDADE_TRATAMENTO'
      #9',N.CD_MUNICIPIO_TRATAMENTO CC_MUNICIPIO_TRATAMENTO'
      #9',M2.DS_MUNICIPIO MUNICIPIO_TRATAMENTO'
      #9',I.NM_INVESTIGADOR INVESTIGADOR'
      #9',N.CD_MEDICO CC_MEDICO'
      #9',ME.NM_MEDICO MEDICO'
      #9',N.CD_RELACOES_SEXO'
      #9',N.CD_MAE_POSITIVO CC_TRANSMISSAO_VERTICAL'
      #9',N.CD_USOU_DROGA CC_DROGA_INJETAVEL'
      #9',N.CD_ACIDENTE_MAT_BIO CC_ACIDENTE_BIOLOGICO'
      #9',N.CD_EVOLUCAO CC_EVOLUCAO'
      #9',N.SN_TRANSFUSAO_SANGUE CC_TRANSFUSAO_SANGUE'
      #9',N.SN_PERFURACAO CC_TRATAMENTO_TRADICIONAL'
      #9',N.SN_TRAT_DENTARIO CC_TRATAMENTO_DENTARIO'
      #9',N.SN_INTERV_CIRURGICA CC_INTERVENCAO_CIRURGICA'
      #9',N.SN_CIRCUNCISAO CC_CIRCUNCISAO'
      #9',N.CD_TESTE_TRIAGEM CC_TESTE_TRIAGEM'
      #9',N.CD_TESTE_CONFIRMATORIO CC_TESTE_CONFIRMATORIO'
      #9',N.CD_OMS CC_ESTADIO_CLINICO'
      #9',N.SN_TATUAGEM CC_TATUAGEM'
      #9',N.EVIDENCIA_GESTANTE CC_EVIDENCIA_GESTANTE'
      #9',N.TB_ATUAL CC_TB_ATUAL'
      #9',N.TB_ATUAL CC_TB_ANTERIOR'
      #9',N.TP_ENTRADA CC_TP_ENTRADA'
      #9',TRIM(TA1.DS_DESCRICAO)ESCOLARIDADE'
      #9',P2.CD_ESCOLARIDADE CC_ESCOLARIDADE'
      #9',P2.ESTADO_CIVIL CC_ESTADO_CIVIL'
      #9',P2.TP_SEXO CC_SEXO'
      #9',P2.FL_GESTANTE CC_GESTANTE'
      #9',P2.FL_RESULTADO CC_RESULTADO'
      #9',case'#9
      #9' when N.CD_RELACOES_SEXO = 1 then '#39'Com Homens'#39
      ' '#9' when N.CD_RELACOES_SEXO = 2 then '#39'Com Mulheres'#39
      ' '#9' when N.CD_RELACOES_SEXO = 3 then '#39'Com Homens e Mulheres'#39
      ' '#9' when N.CD_RELACOES_SEXO =98 then '#39'N'#227'o se aplica'#39' '
      #9'else'
      '  '#9' '#39'NIF'#39
      #9'end as CC_RELACOES_SEXO'
      #9',Case'
      '     when N.CD_TESTE_CONFIRMATORIO=1 then '#39'Positivo'#39
      '     when N.CD_TESTE_CONFIRMATORIO=98 then '#39'N'#227'o Realizado'#39
      '    else'
      '     '#39'NIF'#39
      '    end as TESTE_CONFIRMATORIO'
      #9',case'
      '     when N.EVIDENCIA_GESTANTE=1 then '#39'Antes do pr'#233'-natal'#39
      '     when N.EVIDENCIA_GESTANTE=2 then '#39'Durante o pr'#233'-natal'#39
      '     when N.EVIDENCIA_GESTANTE=3 then '#39'Durante o parto'#39
      '     when N.EVIDENCIA_GESTANTE=4 then '#39'Ap'#243's o parto'#39
      '    else'
      '     '#39'NIF'#39
      '    end as EVIDENCIA_GESTANTE'
      '    ,case'
      '     when N.CD_EVOLUCAO=1 then '#39'Vivo'#39
      '     when N.CD_EVOLUCAO=2 then '#39'Morto'#39
      '     when N.CD_EVOLUCAO=3 then '#39'Transferido'#39
      '     when N.CD_EVOLUCAO=4 then '#39'Abandono'#39
      '     when N.CD_EVOLUCAO=5 then '#39'Ignorado'#39
      #9' when N.CD_EVOLUCAO=6 then '#39'Recusado'#39
      '    else'
      '     '#39'NIF'#39
      '    end as EVOLUCAO'
      '    ,case'
      '     when N.CD_OMS=1 then '#39'Estado Cl'#237'nico I'#39
      '     when N.CD_OMS=2 then '#39'Estado Cl'#237'nico II'#39
      '     when N.CD_OMS=3 then '#39'Estado Cl'#237'nico III'#39
      '     when N.CD_OMS=4 then '#39'Estado Cl'#237'nico IV'#39
      '    else'
      '     '#39'NIF'#39
      '    end as ESTADIO_CLINICO'
      '    ,case'
      '     when N.TB_ATUAL=1 then '#39'N'#227'o'#39
      '     when N.TB_ATUAL=2 then '#39'Sim'#39
      '     when N.TB_ATUAL=3 then '#39'Ignorado'#39
      '    else'
      '     '#39'NIF'#39
      '    end as TB_ATUAL'
      '    ,case'
      '     when N.TP_ENTRADA=1 then '#39'Caso Novo'#39
      '     when N.TP_ENTRADA=2 then '#39'Transfer'#234'ncia'#39
      '     when N.TP_ENTRADA=3 then '#39'Retorno ap'#243's abandono'#39
      '     when N.TP_ENTRADA=4 then '#39'Ignorado'#39
      #9' when N.TP_ENTRADA=5 then '#39'M'#227'e da Crian'#231'a Exposta'#39#9
      '    else'
      '     '#39'NIF'#39
      '    end as TP_ENTRADA'
      '    ,case'
      '     when N.TB_ANTERIOR=1 then '#39'N'#227'o'#39
      '     when N.TB_ANTERIOR=2 then '#39'Sim'#39
      '     when N.TB_ANTERIOR=3 then '#39'Ignorado'#39
      '    else'
      '     '#39'NIF'#39
      '    end as TB_ANTERIOR'
      '    ,case'
      '     when P2.FL_RESULTADO=1 then '#39'Negativo'#39
      '     when P2.FL_RESULTADO=2 then '#39'Positivo'#39
      '     when P2.FL_RESULTADO=3 then '#39'Indeterminado'#39
      '     when P2.FL_RESULTADO=98 then '#39'N'#227'o se aplica'#39
      '    else'
      '     '#39'NIF'#39
      '    end as RESULTADO'
      '    ,case'
      '     when P2.FL_GESTANTE=0 then '#39'N'#227'o'#39
      '     when P2.FL_GESTANTE=1 then '#39'Sim'#39
      '    else'
      '     '#39'NIF'#39
      '    end as GESTANTE'
      '   ,CASE'
      '      when P2.ESTADO_CIVIL=1 then '#39'Solteiro'#39
      '      when P2.ESTADO_CIVIL=2 then '#39'Casado'#39
      '      when P2.ESTADO_CIVIL=3 then '#39'Divorciado'#39
      '      when P2.ESTADO_CIVIL=4 then '#39'Separado'#39
      '      when P2.ESTADO_CIVIL=5 then '#39'Vi'#250'vo'#39
      '      when P2.ESTADO_CIVIL=6 then '#39'Marital'#39
      '   else '#39'NIF'#39' END as ESTADO_CIVIL'
      '   ,CASE'
      '      when P2.tp_sexo='#39'M'#39' then '#39'Masculino'#39
      '      when P2.tp_sexo='#39'F'#39' then '#39'Feminino'#39
      '   else '#39'NIF'#39' END as SEXO'
      '   ,CASE'
      '      when ((P2.idade>=0)  and (P2.idade<=4))  then '#39'0-4'#39
      '      when ((P2.idade>=5)  and (P2.idade<=9))  then '#39'5-9'#39
      '      when ((P2.idade>=10) and (P2.idade<=14)) then '#39'10-14'#39
      '      when ((P2.idade>=15) and (P2.idade<=24)) then '#39'15-24'#39
      '      when ((P2.idade>=25) and (P2.idade<=44)) then '#39'25-44'#39
      '      when ((P2.idade>=45) and (P2.idade<=49)) then '#39'45-49'#39
      '      when (P2.idade>=50) then '#39'50-+'#39
      '  else '#39'NIF'#39' END as FAIXA_ETARIA'
      '  ,p2.*'
      'FROM NOTIFICACAO N'
      #9'LEFT OUTER JOIN PACIENTE P2 ON'
      #9'P2.CD_PACIENTE = N.CD_PACIENTE and'
      '                P2.CD_UND = N.CD_UND'
      #9'LEFT OUTER JOIN OCUPACAO O ON'
      #9'O.CD_OCUPACAO = N.CD_OCUPACAO'
      #9'LEFT OUTER JOIN UNIDADE U ON'
      #9'U.CD_UNIDADE = N.CD_UNIDADE'
      #9'LEFT OUTER JOIN MUNICIPIO M ON'
      #9'M.CD_MUNICIPIO = N.CD_MUNICIPIO'
      #9'LEFT OUTER JOIN PROVINCIA P ON'
      #9'P.CD_PROVINCIA = N.CD_PROVINCIA_NOT'
      #9'LEFT OUTER JOIN UNIDADE U2 ON'
      #9'U2.CD_UNIDADE = N.CD_UNIDADE_TRATAMENTO'
      #9'LEFT OUTER JOIN MUNICIPIO M2 ON'
      #9'M2.CD_MUNICIPIO = N.CD_MUNICIPIO_TRATAMENTO'
      '                LEFT OUTER JOIN INVESTIGADOR I ON'
      #9'I.CD_INVESTIGADOR = N.CD_INVESTIGADOR and'
      #9'I.CD_UND = N.CD_UND'
      #9'LEFT OUTER JOIN MEDICO ME ON'
      #9'ME.CD_MEDICO = N.CD_MEDICO and'
      #9'ME.CD_UND = N.CD_UND'
      #9'LEFT OUTER JOIN TABELA_AUXILIAR TA1 ON'
      #9'P2.CD_ESCOLARIDADE = TA1.CD_CODIGO'
      #9'AND TA1.CD_TABELA = 1')
    ModifySQL.Strings = (
      'update "NOTIFICACAO"'
      'set'
      ' CD_FICHA = :CD_FICHA'
      'where'
      ' 1=2')
    Left = 536
    Top = 224
  end
  object qyAtualizaFlagAbandono: TIBQuery
    Database = DM.DB
    Transaction = DM.TS
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'UPDATE NOTIFICACAO'
      'SET CD_EVOLUCAO = 4'
      'WHERE CD_PACIENTE in(select'
      #9#9'PACIENTE.cd_paciente'
      #9'from AGENDA A'
      #9'join PACIENTE'
      #9#9'on PACIENTE.cd_paciente = A.cd_paciente'
      #9#9'and PACIENTE.cd_und = A.cd_und'
      #9'where (A.fl_realizado = 0'
      #9#9'and ((A.fl_parecer = 0) or (A.fl_parecer is null))'
      #9#9'and ((A.fl_remarcado = 0) or (A.fl_remarcado is null)))'
      #9#9'and  not exists(select 1 from agenda X'
      #9#9#9'where X.cd_paciente = A.cd_paciente'
      #9#9#9'and X.dt_agenda > A.dt_agenda)'
      #9#9'and  A.DT_AGENDA < (cast('#39'now'#39' as timestamp)-1)'
      #9#9'and A.DT_AGENDA <= (cast('#39'now'#39' as timestamp)/*nDiasAbandono*/)'
      
        ') and CD_UND = (SELECT CD_UND FROM PACIENTE WHERE CD_PACIENTE = ' +
        'NOTIFICACAO.CD_PACIENTE)')
    Left = 472
    Top = 328
  end
end
